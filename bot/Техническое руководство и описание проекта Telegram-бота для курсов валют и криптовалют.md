# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ Telegram-–±–æ—Ç–∞ –¥–ª—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç

  

## 1.

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π Telegram-–±–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:

- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≤–∞–ª—é—Ç (USD, EUR, GBP) –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ RUB.
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫—É—Ä—Å—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç (BTC, ETH, BNB, XRP, SOL, ADA, DOGE, DOT, TRX, LINK) –≤ USD.
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É–º–º—É –∏–∑ –æ–¥–Ω–æ–π –≤–∞–ª—é—Ç—ã –≤ –¥—Ä—É–≥—É—é (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–µ –º–∏—Ä–æ–≤—ã–µ –≤–∞–ª—é—Ç—ã).

---

## 2. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

### 2.1. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

- –î–ª—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API [ExchangeRate-API](https://www.exchangerate-api.com/).
- –î–ª—è –∫—É—Ä—Å–æ–≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç ‚Äî API CoinGecko (https://api.coingecko.com/api/v3/simple/price).

### 2.2. –ê–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π /start.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é: –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç, –∫—É—Ä—Å—ã –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç, –∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä –≤–∞–ª—é—Ç.
- –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±–æ—Ä–∞, –±–æ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –º–µ–Ω—é.
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–ª—é—Ç—ã –∏–ª–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –±–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –∫—É—Ä—Å –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –µ–≥–æ.
- –í —Ä–µ–∂–∏–º–µ –∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∑–∞–ø—Ä–æ—Å –≤ —Ñ–æ—Ä–º–∞—Ç–µ: 100 USD to RUB, –±–æ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–æ—Ç–∞

### 3.1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **API-–∑–∞–ø—Ä–æ—Å—ã:** —Ñ—É–Ω–∫—Ü–∏–∏ get_exchange_rate –∏ get_crypto_rate –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –≤–Ω–µ—à–Ω–∏—Ö API.
- **–ú–µ–Ω—é –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã:** —Ñ—É–Ω–∫—Ü–∏–∏, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏ (get_main_menu, get_currency_menu, get_crypto_menu, get_converter_menu).
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:** —Ñ—É–Ω–∫—Ü–∏–∏ start, button –∏ handle_message –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è.
- **–°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** —Å–ª–æ–≤–∞—Ä—å user_states —Ö—Ä–∞–Ω–∏—Ç, –≤ –∫–∞–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–∂–∏–¥–∞–µ—Ç –≤–≤–æ–¥ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏).

---

### 3.2. –î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (UML –¥–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)

```javascript
plaintext
```


```javascript
+----------------+
|    Telegram    |
|     User       |
+--------+-------+
         |
         v
+----------------+
|  Telegram Bot  |
| (Application)  |
+-------+--------+
        |
        +--------------------+
        |                    |
        v                    v
+--------------+     +------------------+
| API –∑–∞–ø—Ä–æ—Å—ã  |     |   –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏    |
| (exchange,   |     | (start, button,  |
|  crypto)     |     |  handle_message) |
+--------------+     +------------------+
        |
        v
+----------------+
| –í–Ω–µ—à–Ω–∏–µ API    |
| (ExchangeRate, |
|  CoinGecko)    |
+----------------+
```

---

## 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –±–æ—Ç–∞

### 4.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python 3.8+.
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```javascript
bash
```


```javascript
pip install python-telegram-bot requests
```

- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞ —É BotFather –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω.

---

### 4.2. –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞

#### –®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

```javascript
python
```


```javascript
import requests
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, CallbackQueryHandler, CallbackContext, MessageHandler, filters

user_states = {}  # –•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

#### –®–∞–≥ 2: –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç

```javascript
python
```


```javascript
def get_exchange_rate(base: str, target='RUB'):
    url = f"https://api.exchangerate-api.com/v4/latest/{base}"
    try:
        response = requests.get(url)
        data = response.json()
        return data['rates'].get(target)
    except:
        return None

def get_crypto_rate(crypto_id):
    try:
        url = f"https://api.coingecko.com/api/v3/simple/price?ids={crypto_id}&vs_currencies=usd"
        response = requests.get(url)
        data = response.json()
        return data[crypto_id]['usd']
    except:
        return None
```

#### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏

```javascript
python
```


```javascript
def get_main_menu():
    keyboard = [
        [InlineKeyboardButton("üí∞ –ö—É—Ä—Å –≤–∞–ª—é—Ç", callback_data='currency')],
        [InlineKeyboardButton("ü™ô –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞", callback_data='crypto')],
        [InlineKeyboardButton("üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–æ—Ä", callback_data='converter')]
    ]
    return InlineKeyboardMarkup(keyboard)

# –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è get_currency_menu, get_crypto_menu –∏ get_converter_menu
```

#### –®–∞–≥ 4: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start

```javascript
python
```


```javascript
async def start(update: Update, context: CallbackContext):
    user = update.effective_user
    name = user.first_name if user.first_name else "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    welcome_text = f"üëã –ü—Ä–∏–≤–µ—Ç, {name}!\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
    await update.message.reply_text(welcome_text, reply_markup=get_main_menu())
```

#### –®–∞–≥ 5: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫

```javascript
python
```


```javascript
async def button(update: Update, context: CallbackContext):
    query = update.callback_query
    await query.answer()
    data = query.data
    user_id = query.from_user.id

    if data == 'currency':
        await query.edit_message_text("–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞–ª—é—Ç—É:", reply_markup=get_currency_menu())
    # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø–æ –∫–æ–¥—É
```

#### –®–∞–≥ 6: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

```javascript
python
```


```javascript
async def handle_message(update: Update, context: CallbackContext):
    user_id = update.effective_user.id
    if user_states.get(user_id) == 'awaiting_conversion':
        text = update.message.text.strip().upper()
        try:
            parts = text.split()
            amount = float(parts[0])
            base = parts[1]
            target = parts[3] if parts[2] == 'TO' else None

            if not target:
                raise ValueError

            rate = get_exchange_rate(base, target)
            if rate:
                converted = round(amount * rate, 2)
                await update.message.reply_text(f"üîÅ {amount} {base} = {converted} {target}")
                user_states[user_id] = None
                await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –¥–∞–ª–µ–µ:", reply_markup=get_main_menu())
            else:
                await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å –¥–ª—è —ç—Ç–∏—Ö –≤–∞–ª—é—Ç.")
        except:
            await update.message.reply_text("‚ö†Ô∏è –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ü—Ä–∏–º–µ—Ä:\n`100 USD to RUB`", parse_mode='Markdown')
    else:
        await update.message.reply_text("‚ö†Ô∏è –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é –∏–∑ –º–µ–Ω—é –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∫–æ–º–∞–Ω–¥—É.")
```

#### –®–∞–≥ 7: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```javascript
python
```


```javascript
def main():
    app = Application.builder().token("–í–ê–®_–¢–û–ö–ï–ù").build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CallbackQueryHandler(button))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    app.run_polling()

if __name__ == '__main__':
    main()
```

---

## 5. –ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏

### 5.1. –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –ø–æ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```javascript
plaintext
```


```javascript
[–°—Ç–∞—Ä—Ç] --> [–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é]
            |           |          |
            v           v          v
     [–ö—É—Ä—Å –≤–∞–ª—é—Ç]  [–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞] [–ö–æ–Ω–≤–µ—Ä—Ç–æ—Ä]
            |           |          |
       [–í—ã–±–æ—Ä –≤–∞–ª—é—Ç—ã] [–í—ã–±–æ—Ä –∫—Ä–∏–ø—Ç—ã] [–í–≤–æ–¥ —Å—É–º–º—ã]
```


